{% extends 'base.html' %}
{% load static %}
{% block content %}
<style>
    #picture-preview img {
        max-width: 100%;
        max-height: 100%;
        object-fit: cover;
    }
</style>
<div class="page-header card">
    <div class="row align-items-end">
        <!-- <div class="col-lg-8">
            <div class="page-header-title">
                <i class="feather icon-home bg-c-blue"></i>
                <div class="d-inline">
                    <h5>User-Detail</h5>
                    <span>The scanned user info</span>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="page-header-breadcrumb">
                <ul class=" breadcrumb breadcrumb-title">
                    <li class="breadcrumb-item">
                        <a href="index.html"><i class="feather icon-home"></i></a>
                    </li>
                    <li class="breadcrumb-item"><a href="#!">Dashboard Analytics</a> </li>
                </ul>
            </div>
        </div> -->
        <div class="page-header card">
            <!-- Rest of your HTML code -->
        </div>

        <div class="pcoded-inner-content">
            <!-- Rest of your HTML code -->
        </div>
        <div class="col-xl-12 col-md-12">
            <div class="card latest-update-card">
                <div id="countdown-timer" style="font-size: 40px;font-weight: bold;" class="p-4"></div>
            </div>
        </div>
        <div class="col-xl-12 col-md-12">
            <div class="card latest-update-card">
                <div class="card-header">
                    <h5>Full User Detail</h5>
                    <div class="card-header-right">
                        <ul class="list-unstyled card-option">
                            <li class="first-opt"><i class="feather icon-chevron-left open-card-option"></i>
                            </li>
                            <li><i class="feather icon-maximize full-card"></i></li>
                            <li><i class="feather icon-minus minimize-card"></i>
                            </li>
                            <li><i class="feather icon-refresh-cw reload-card"></i>
                            </li>
                            <li><i class="feather icon-trash close-card"></i></li>
                            <li><i class="feather icon-chevron-left open-card-option"></i>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-block">
                    <div class="col-6">
                        <div class="latest-update-box">
                            <div class="row p-t-20 p-b-30">
                                <div class="col-auto text-right update-meta p-r-0">
                                    {% if userInfo.profileImage %}
                                    <img src="{{userInfo.profileImage.url}}" alt="user image" class="img-radius "
                                        width="70" height="70">
                                    {% endif %}
                                </div>
                                <div class="col p-l-5">
                                    <a href="#!">
                                        <h4>{{userInfo.fullName}}.</h4>
                                    </a>
                                    <p class="text-muted m-b-0">{{userInfo.number}}</p>
                                </div>
                            </div>
                            <div class="row p-b-30">
                                <div class="col-auto text-right update-meta p-r-0">
                                    <i class="fea  "></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </div>
                                <div class="col p-l-5">
                                    <a href="#!">
                                        <h6>User Type.</h6>
                                    </a>
                                    <p class="text-muted m-b-0">{{userInfo.userType}}</p>
                                </div>
                            </div>
                        </div>
                    </div>



                </div>
            </div>
        </div>
    </div>
</div>

<div class="pcoded-inner-content">

    <div class="main-body">
        <div class="page-wrapper">

            <div class="page-body">

                <div class="card">
                    <div class="card-header">
                        <h5>Border Info</h5>

                    </div>
                    <div class="card-block">
                        <div class="table-responsive dt-responsive">
                            <table id="dom-jqry" class="table table-striped table-bordered nowrap">
                                <thead>
                                    <tr>
                                        <th>B-Generated ID</th>
                                        <th>ID Card No</th>
                                        <th>Current-Status</th>
                                        <th>Expire Date</th>
                                        <th>ReasonFor</th>
                                        <th>User Address</th>
                                        <th>Entering Date</th>
                                        <th>Nationality</th>
                                        <th>Landed Type</th>
                                        <th>Registration Date</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for border in allBorders %}
                                    <tr>
                                        <td>{{ border.borderGeneratedId }}</td>
                                        <td>{{ border.idCardNo }}</td>
                                        <td>{{ border.borderCurrentState }}</td>
                                        <td style="color:red">{{ border.expireDate }}</td>
                                        <td>{{ border.reasonFor }}</td>
                                        <td>{{ border.userAddress }}</td>
                                        <td>{{ border.enteringDate }}</td>
                                        <td>{{ border.nationality }}</td>
                                        <td>{{ border.userLandedType }}</td>
                                        <td>{{ border.registrationDate }}</td>
                                        <td>
                                            <a target="_blank"
                                                href='/admin/api/borderregistration/{{border.id}}/change/'
                                                class="btn btn-primary btn-sm edit-user">Edit</a>
                                            <a target="_blank"
                                                href="/admin/api/borderregistration/{{border.id}}/change/"
                                                class="btn btn-info btn-sm">Detail</a>
                                            <a target="_blank"
                                                href="/admin/api/borderregistration/{{border.id}}/delete/"
                                                class="btn btn-danger btn-sm">Delete</a>
                                        </td>
                                        <!-- <td>
                                            {% for product in border.userProducts.all %}
                                            {{ product.name }}{% if not forloop.last %}, {% endif %}
                                            {% endfor %}
                                        </td> -->

                                    </tr>
                                    {% endfor %}
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5>Border Messages</h5>

                    </div>
                    <div class="card-block">
                        <div class="table-responsive dt-responsive">
                            <table id="dom-jqry" class="table table-striped table-bordered nowrap">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Message</th>
                                        <th>Date</th>
                                        <th>action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for message in allMessages %}
                                    <tr>
                                      <td>{{ message.messageTitle }}</td>
                                      <td>{{ message.fullText }}</td>
                                      <td>{{ message.date }}</td>
                                      <td>
                                        <a target="_blank" href='/admin/api/messagesfor/{{message.id}}/change/' class="btn btn-primary btn-sm edit-user">Edit</a>
                                        <a target="_blank" href="/admin/api/messagesfor/{{message.id}}/change/" class="btn btn-info btn-sm">Detail</a>
                                        <a target="_blank" href="/admin/api/messagesfor/{{message.id}}/delete/" class="btn btn-danger btn-sm">Delete</a>
                                    </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>





            </div>

        </div>
    </div>

    <div id="styleSelector">
    </div>
</div>
<script>
    // Get the expiration date from the server-side and convert it to JavaScript Date object
    var dateString = "{{ latestBorder.expireDate|date:'Y-m-d H:i:s' }}";
var expirationDate = new Date(dateString);
    // Function to update the countdown timer
    function updateCountdown() {
        var now = new Date(); // Get the current date and time

        // Calculate the remaining time in milliseconds
        var remainingTime = expirationDate.getTime() - now.getTime();

        if (remainingTime <= 0) {
            // If the expiration date has passed
            document.getElementById("countdown-timer").textContent = "Expired";
            document.getElementById("countdown-timer").style = "color:red;font-size: 40px;font-weight: bold;";
        } else {
            // Calculate the remaining days, hours, minutes, and seconds
            var days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));
            var hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);

            // Format the countdown timer as "X days, XX:XX:XX"
            var timerText = days + " DAYS,  " + formatTime(hours) + " : " + formatTime(minutes) + " : " + formatTime(seconds);
            document.getElementById("countdown-timer").textContent = timerText;
        }
    }

    // Helper function to format the time with leading zeros
    function formatTime(time) {
        return time.toString().padStart(2, "0");
    }

    // Update the countdown timer every second
    setInterval(updateCountdown, 1000);
</script>
{% endblock %}